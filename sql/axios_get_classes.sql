SELECT TCls.iClsId, 
TCls.iAcsId, TCls.iSezId, TCls.iIndId, TCls.iDwgSedId, 
TCls.iSpzId,   TCls.iClsOrdine, TCls.iDwgId, TAns.iAnsId, TAcs.iAcsAnnoCorso, TCls.iTmsId,     
        TCls.dStart, TCls.dEnd, TCls.dDelete, TCls.dInsert, TCls.ICLSCODSEDESIDI,  
                     TAcs.sAcsSDesc, TSez.sSezLDesc, TSez.sSezSDesc, TInd.sIndLDesc, VSed.sSedMecCod, 
                            TSpz.sSpzSperim, TSpz.sSpzSpecial, TAns.iAnsValore,   
                                                              CASE WHEN TAcs.IACSID IN (8, 9, 10)
                                                               THEN TAcs.SACSSDESC || ' (' || TAcs.SACSLDESC || ' CLASSICO)'  
                                                                  WHEN TAcs.IACSID IN (6, 7) OR TAcs.IACSID > 10 THEN TAcs.SACSSDESC || ' (' || TAcs.SACSLDESC || ')'   ELSE TAcs.SACSSDESC END AS ANNOCRONOLOGICO, TTms.sTmsCodSiis,                                             (SELECT FIRST 1                                                                            CASE                                                                                      WHEN cp.ICLSPSTCODCLSSIDI = 0 THEN 'ESCLUSA'                                          WHEN cp.ICLSPSTCODCLSSIDI IS NOT NULL THEN scls.IDENTIFICATIVOCLASSE                  END                                                                                   FROM TCLSPST cp                                                                           LEFT JOIN TSISCLS_CLASSI scls ON scls.CODICECLASSESIDI = cp.ICLSPSTCODCLSSIDI         WHERE cp.ICLSID = TCls.ICLSID) AS CodSIDI,                                             NULL AS CodWar, CAST(NULL AS VARCHAR(150)) AS Warning                                 FROM TCls_Classi TCls                                                                   INNER JOIN TAns_AnniScolast TAns ON (TCls.dStart BETWEEN TAns.dAnsAxiosInizio AND TAns.dAnsAxiosFine) INNER JOIN TAcs_AnniCorso TAcs ON (TAcs.iAcsId = TCls.iAcsId) INNER JOIN TSez_Sezioni TSez ON (TSez.iSezId = TCls.iSezId) INNER JOIN TInd_Indirizzo TInd ON (TInd.iIndId = TCls.iIndId) INNER JOIN VSed_Sedi VSed ON (VSed.iDwgSedId = TCls.iDwgSedId) LEFT  JOIN TSpz_SpecSper TSpz ON (TSpz.iSpzId = TCls.iSpzId) LEFT  JOIN TTms_TempoScuola TTms ON TTms.iTmsId = TCls.iTmsId WHERE (TCls.dDelete IS NULL) AND (TCls.iDwgId = 102)   AND (TAns.iAnsId = 44) and tsez.SSEZLDESC='ATE' ORDER BY TCls.iClsOrdine